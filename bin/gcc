#! /bin/bash

panic()
{
	echo "FATAL ERROR: $@" 1>&2
	exit 1
}

eprint()
{
	echo "$@" 1>&2
}

cmd_dir=`dirname $0` || panic "cannot get command directory"
debug_level=${SDE_DEBUG_LEVEL:-0}

if [ -z "$SDE_CC" ]; then
	panic "SDE_CC not set"
fi
if [ ! -x "$SDE_CC" ]; then
	panic "no execute permission on file $SDE_CC"
fi

unset opts
if [ -n "$SDE_CC_OPTIONS_PREFIX" ]; then
	opts+=($SDE_CC_OPTIONS_PREFIX)
fi
opts+=("$@")
if [ -n "$SDE_CC_OPTIONS_SUFFIX" ]; then
	opts+=($SDE_CC_OPTIONS_SUFFIX)
fi

if [ $debug_level -ge 1 ]; then
	eprint "Running $SDE_CC ${opts[@]}"
fi
"$SDE_CC" "${opts[@]}"

